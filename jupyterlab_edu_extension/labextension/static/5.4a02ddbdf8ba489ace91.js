"use strict";(self.webpackChunkjupyterlab_edu_extension=self.webpackChunkjupyterlab_edu_extension||[]).push([[5],{5:(e,o,a)=>{a.d(o,{ConfigurationWidget:()=>i});var n=a(247),t=a(827);class i{static async showConfigDialog(){const e=document.createElement("div");if(e.className="jp-edu-config-dialog",e.innerHTML='\n            <div class="jp-edu-config-section">\n                <h4>ğŸ”‘ OpenAI è¨­å®šï¼ˆå¿…è¦ï¼‰</h4>\n                <p class="jp-edu-config-hint">ç”¨æ–¼ AI åŠ©æ•™åŠŸèƒ½ã€‚å‰å¾€ <a href="https://platform.openai.com" target="_blank">platform.openai.com</a> å–å¾— API Keyã€‚</p>\n                <div class="jp-edu-form-group">\n                    <label for="openai-key">OpenAI API Key *</label>\n                    <input type="password" id="openai-key" placeholder="sk-..." autocomplete="off" />\n                </div>\n                <div class="jp-edu-form-group">\n                    <label for="openai-model">æ¨¡å‹</label>\n                    <select id="openai-model">\n                        <option value="gpt-4o-mini">gpt-4o-miniï¼ˆç¶“æ¿Ÿå¯¦æƒ ï¼‰</option>\n                        <option value="gpt-5-nano" selected>gpt-5-nanoï¼ˆæ¨è–¦ï¼‰</option>\n                        <option value="gpt-5-mini">gpt-5-miniï¼ˆé€²éšï¼‰</option>\n                        <option value="gpt-5">gpt-5ï¼ˆæœ€å¼·ï¼‰</option>\n                    </select>\n                </div>\n            </div>\n            \n            <div class="jp-edu-config-section">\n                <h4>â˜ï¸ Supabase è¨­å®šï¼ˆé¸å¡«ï¼‰</h4>\n                <p class="jp-edu-config-hint">ç”¨æ–¼é›²ç«¯å„²å­˜å­¸ç¿’ç´€éŒ„ã€‚è‹¥ä¸è¨­å®šï¼Œè³‡æ–™åƒ…å­˜æ–¼æœ¬æ©Ÿã€‚</p>\n                <div class="jp-edu-form-group">\n                    <label for="supabase-url">Supabase URL</label>\n                    <input type="text" id="supabase-url" placeholder="https://xxx.supabase.co" autocomplete="off" />\n                </div>\n                <div class="jp-edu-form-group">\n                    <label for="supabase-anon-key">Supabase Anon Key</label>\n                    <input type="password" id="supabase-anon-key" placeholder="eyJ..." autocomplete="off" />\n                </div>\n                <div class="jp-edu-form-group">\n                    <label for="supabase-service-key">Supabase Service Role Keyï¼ˆç®¡ç†å“¡ç”¨ï¼‰</label>\n                    <input type="password" id="supabase-service-key" placeholder="eyJ..." autocomplete="off" />\n                </div>\n            </div>\n        ',(await(0,t.showDialog)({title:"âš™ï¸ æ•™å­¸æ“´å±•è¨­å®š",body:new n.Widget({node:e}),buttons:[t.Dialog.cancelButton({label:"ç¨å¾Œè¨­å®š"}),t.Dialog.okButton({label:"å„²å­˜è¨­å®š"})]})).button.accept){const o=e.querySelector("#openai-key").value.trim(),a=e.querySelector("#openai-model").value,n=e.querySelector("#supabase-url").value.trim(),i=e.querySelector("#supabase-anon-key").value.trim(),l=e.querySelector("#supabase-service-key").value.trim();if(!o)return await(0,t.showDialog)({title:"éŒ¯èª¤",body:"OpenAI API Key ç‚ºå¿…å¡«æ¬„ä½",buttons:[t.Dialog.okButton({label:"ç¢ºå®š"})]}),!1;try{const e=document.cookie.split("; ").find(e=>e.startsWith("_xsrf="))?.split("=")[1]||"";if((await fetch("/edu-extension/api/config/save",{method:"POST",headers:{"Content-Type":"application/json","X-XSRFToken":e},body:JSON.stringify({openai_api_key:o,openai_model:a,supabase_url:n,supabase_anon_key:i,supabase_service_role_key:l})})).ok)return await(0,t.showDialog)({title:"æˆåŠŸ",body:"è¨­å®šå·²å„²å­˜ï¼è«‹é‡æ–°æ•´ç†é é¢ä»¥è¼‰å…¥æ–°è¨­å®šã€‚",buttons:[t.Dialog.okButton({label:"ç¢ºå®š"})]}),!0;throw new Error("å„²å­˜å¤±æ•—")}catch(e){return await(0,t.showDialog)({title:"éŒ¯èª¤",body:"ç„¡æ³•å„²å­˜è¨­å®šï¼Œè«‹ç¢ºèªå¾Œç«¯æœå‹™æ­£å¸¸é‹ä½œã€‚",buttons:[t.Dialog.okButton({label:"ç¢ºå®š"})]}),!1}}return!1}static async checkAndPromptConfig(){try{const e=await fetch("/edu-extension/api/health");(await e.json()).openai_configured||(console.log("[Configuration] OpenAI æœªè¨­å®šï¼Œé¡¯ç¤ºé…ç½®å°è©±æ¡†"),await this.showConfigDialog())}catch(e){console.error("[Configuration] ç„¡æ³•æª¢æŸ¥é…ç½®ç‹€æ…‹:",e)}}}}}]);